@model AlbumReviews.ViewModels.AlbumReviewViewModel

<div style="display: flex; align-items: center;">
    <img src="@Model.Cover" alt="Cover image of @Model.Title" style="width: 150px; height: auto; margin-right: 20px;" class="album-cover" />
    <h1>@Model.Title</h1>
</div>

@if (User.Identity.IsAuthenticated)
{
    <form method="post" asp-action="AddReview" asp-route-albumId="@Model.AlbumId">
        @Html.AntiForgeryToken()
        <div>
            <label for="rating">Rating:</label>
            <input type="number" name="rating" id="rating" min="0" max="100" required />
        </div>
        <div>
            <label for="reviewContent">Review:</label><br />
            <textarea name="reviewContent" rows="4" cols="50" required></textarea><br />
        </div>
        <input type="submit" value="Submit Review" />
    </form>
}
else
{
    <p>Please <a asp-page="/Identity/Account/Login">login</a> to add a review.</p>
}

@if (Model.Reviews != null && Model.Reviews.Count > 0)
{
    <ul>
        @foreach (var review in Model.Reviews)
        {
            <li>
                <p>Rating: @review.Rating</p>
                <div style="height: 5px; background-color: @(review.Rating <= 33 ? "red" : review.Rating <= 66 ? "yellow" : "green");"></div>
                <p>@review.ReviewContent</p>
                <p>By: @review.UserName</p>
                @if (User.Identity.IsAuthenticated && User.Identity.Name == review.UserName)
                {
                    <form method="post" asp-action="DeleteReview" asp-route-reviewId="@review.ReviewId" asp-route-albumId="@Model.AlbumId">
                        @Html.AntiForgeryToken()
                        <input type="submit" value="Delete" />
                    </form>
                }
            </li>
        }
    </ul>
}
else
{
    <p>No reviews available for this album.</p>
}

@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
    }
